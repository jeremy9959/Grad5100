library(tidyverse)
data <- read_csv("data/cookie_cats.csv")
## Utility functions to run fisher test
fisher_setup <- function(x,y) {
result <- x |> select(`version`,{{y}}) |>
group_by(`version`) |>
count({{y}}) |>
pivot_wider(names_from={{y}},values_from =`n`)|>
ungroup()
return (result)
}
fisher_test<-function(x,y) {
setup <- fisher_setup(x,{{y}})
result <- fisher.test(setup |> select(-`version`))
return(result$p.value)
}
print(head(data))
non_players <-data|> filter(`sum_gamerounds`==0)
n_non_players <- pull(non_players|>count())
print(paste("Non-players:" ,n_non_players))
non_players <-data|> filter(`sum_gamerounds`==0)
n_non_players <- pull(non_players|>count())
print(paste("Non-players:" ,n_non_players))
players <- data |> filter(`sum_gamerounds`>0)
players |> group_by(`version`) |> summarize(p1=mean(`retention_1`))
p_1<- fisher_test(players,retention_1)
print(paste("p-value: ",p_1))
continuers <- players |> filter(`retention_1`==TRUE)
continuers |> group_by(`version`) |> summarize(p7=mean(`retention_7`))
p_7<- fisher_test(players,retention_7)
print(paste("p-value: ",p_7))
