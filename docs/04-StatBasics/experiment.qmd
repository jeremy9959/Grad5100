```{r}
library(ggplot2)
rejection <- function(n) {
    results <- data.frame(x=seq(0,n),y=dbinom(seq(0,n),n,.5),keep=sapply(seq(0,n),function(x) (x<qbinom(.025,n,.5)) | (x>qbinom(.975,n,.5))))
    ggplot(data=results,aes(x=x,y=y,fill=keep))+geom_bar(stat="identity")+
    scale_x_continuous(breaks=seq(0,n))

}
```
