<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeremy Teitelbaum">

<title>Probability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="stat-basics_files/libs/clipboard/clipboard.min.js"></script>
<script src="stat-basics_files/libs/quarto-html/quarto.js"></script>
<script src="stat-basics_files/libs/quarto-html/popper.min.js"></script>
<script src="stat-basics_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="stat-basics_files/libs/quarto-html/anchor.min.js"></script>
<link href="stat-basics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="stat-basics_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="stat-basics_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="stat-basics_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="stat-basics_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Probability</h1>
<p class="subtitle lead">Fundamentals of Data Science</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jeremy Teitelbaum </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="populations-and-samples" class="level1">
<h1>Populations and Samples</h1>
<section id="probability-theory" class="level2">
<h2 class="anchored" data-anchor-id="probability-theory">Probability Theory</h2>
<p>Probability theory is based on:</p>
<ul>
<li>An underlying collection <span class="math inline">\(S\)</span> of all possible outcomes (a <em>population</em> or <em>sample space</em>) of an experiment.</li>
<li>A rule <span class="math inline">\(P\)</span> that assigns a number between zero and one to each subset of the sample space satisfying certain rules.</li>
</ul>
</section>
<section id="sample-space" class="level2">
<h2 class="anchored" data-anchor-id="sample-space">Sample Space</h2>
<p>For example:</p>
<ul>
<li><p>For a flip of a single coin, the possible outcomes are Heads and Tails and the sample space has two elements. For multiple flips, the outcomes are sequences of Heads and Tails.</p></li>
<li><p>For a measurement of temperature, we might model the possible outcomes, or the sample space, as all real numbers, recognizing that only some of them are actually possible results of the experiment.</p></li>
</ul>
</section>
<section id="simple-events" class="level2">
<h2 class="anchored" data-anchor-id="simple-events">Simple Events</h2>
<p>The elements of the sample space or population are the <em>outcomes</em> or <em>simple events</em> or <em>sample points</em>.</p>
<ul>
<li><p>For a flip of a coin, the possible outcomes are Heads or Tails. For multiple flips, the possible outcomes are particular sequences of Heads or Tails.</p></li>
<li><p>For a measurement of temperature, a simple event would be a particular number obtained at a particular time.</p></li>
</ul>
</section>
<section id="events" class="level2">
<h2 class="anchored" data-anchor-id="events">Events</h2>
<p>Subsets of the population make up events or outcomes.</p>
<ul>
<li><p>Among the population made up of sequences of 10 coin flips, the subset consisting of sequences containing at least 3 heads is an event.</p></li>
<li><p>Among the measurements of temperature, a measurement lying between say 22 and 25 degrees celsius would be an event.</p></li>
</ul>
</section>
<section id="probability-measure" class="level2">
<h2 class="anchored" data-anchor-id="probability-measure">Probability Measure</h2>
<p>The last element of probability theory is the function P that assigns a number between 0 and 1 to every event such that</p>
<ul>
<li><span class="math inline">\(P(\emptyset)=0\)</span></li>
<li><span class="math inline">\(P(S)=1\)</span>.</li>
<li>If <span class="math inline">\(A\cap B=\emptyset\)</span> then <span class="math inline">\(P(A\cup B)=P(A)+P(B)\)</span>. This is also required to hold for <em>infinite</em> collections of disjoint sets but we won’t worry much about the foundations of probability.</li>
</ul>
</section>
<section id="random-variables" class="level2">
<h2 class="anchored" data-anchor-id="random-variables">Random Variables</h2>
<p>A <em>random variable</em> is a rule that assigns a number to an event.</p>
<ul>
<li>We can assign the value 1 to heads and 0 to tails. This is a <em>bernoulli</em> random variable.</li>
<li>Our sample space can be sets of 10 coin flips. The number of heads is a random variable.</li>
<li>The measurement of temperature yields a number.<br>
</li>
<li>If we pick a person at random, we can assign the value 1 if they wear glasses and 0 if not.</li>
</ul>
</section>
<section id="discrete-vs-continuous-random-variables" class="level2">
<h2 class="anchored" data-anchor-id="discrete-vs-continuous-random-variables">Discrete vs Continuous Random Variables</h2>
<p>A discrete random variables takes “separate” values depending on the event. A continuous random variable takes values in a range.</p>
<ul>
<li>Bernoulli random variable is discrete (0/1)</li>
<li>Number of heads in 10 flips is discrete (takes values 0,…,10)</li>
<li>Temperature is continuous (in principle can get any reading)</li>
<li>Mass of a penguin is continuous</li>
<li>Species of penguin is discrete</li>
</ul>
</section>
<section id="events-and-random-variables" class="level2">
<h2 class="anchored" data-anchor-id="events-and-random-variables">Events and Random Variables</h2>
<p>Specifying a value, or a range of values, for a random variable defines an event.</p>
</section>
<section id="bernoulli-example" class="level2">
<h2 class="anchored" data-anchor-id="bernoulli-example">Bernoulli example</h2>
<ul>
<li>Sample space is <span class="math inline">\(\{H,T\}\)</span></li>
<li><span class="math inline">\(P(H)=p\)</span></li>
<li><span class="math inline">\(X\)</span> is the random variable with <span class="math inline">\(X(H)=1\)</span> and <span class="math inline">\(X(T)=0\)</span></li>
</ul>
<p>Then:</p>
<ul>
<li><span class="math inline">\(X=1\)</span> is the same as the event <span class="math inline">\(H\)</span></li>
<li><span class="math inline">\(P(X=1)\)</span>=p</li>
</ul>
</section>
<section id="binomial-example" class="level2">
<h2 class="anchored" data-anchor-id="binomial-example">Binomial Example</h2>
<p>A binomial random variable (with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>) is the sum of <span class="math inline">\(n\)</span> bernoulli random variables with probability <span class="math inline">\(p\)</span>. It corresponds to flipping a coin (with <span class="math inline">\(P(H)=p\)</span>) <span class="math inline">\(n\)</span> times and counting up the heads.</p>
<p>The probability of getting <span class="math inline">\(k\)</span> heads is <span class="math display">\[
P(k)=\binom{n}{k}p^k(1-p)^{n-k}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">10</span>, .<span class="dv">3</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">y =</span> x), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Number of Heads"</span>) <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"10 Flips, P(H)=.3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="continuous-example" class="level2">
<h2 class="anchored" data-anchor-id="continuous-example">Continuous example</h2>
<ul>
<li>Sample space is the possible temperatures at a particular point in space and time.</li>
<li>Random variable <span class="math inline">\(T\)</span> is a measure of temperature.</li>
<li><span class="math inline">\(P(21&lt;T&lt;22)\)</span> is the probability that the temperature is between 21 and 22 degrees.</li>
</ul>
</section>
<section id="probability-density-functions" class="level2">
<h2 class="anchored" data-anchor-id="probability-density-functions">Probability density functions</h2>
<p>In the continuous case, probability is measured by a probability density function <span class="math inline">\(P(x)\)</span>. The classic example is the normal (bell-shaped) curve.</p>
</section>
<section id="area-gives-probability" class="level2">
<h2 class="anchored" data-anchor-id="area-gives-probability">Area gives probability</h2>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If <span class="math inline">\(P(x)\)</span> is the density function, then:</p>
<blockquote class="blockquote">
<p>the probability that <span class="math inline">\(x\)</span> lies between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> is the area under density function between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</p>
</blockquote>
<p>The shaded area gives probability 0.87 for temp between 21.7 and 22.3.</p>
</section>
<section id="standard-normal" class="level2">
<h2 class="anchored" data-anchor-id="standard-normal">Standard Normal</h2>
<p>A normal curve is defined by two parameters:</p>
<ul>
<li>the mean <span class="math inline">\(\mu\)</span>, which sets the <em>location</em></li>
<li>the standard deviation <span class="math inline">\(\sigma\)</span> or its square, the variance <span class="math inline">\(\sigma^2\)</span>, which sets the <em>scale</em>.</li>
</ul>
<p>If <span class="math inline">\(x\)</span> is a normal random variable with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>, then <span class="math display">\[
z = \frac{x-\mu}{\sigma}
\]</span> is a normal random variable with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(1\)</span>. This is called a <span class="math inline">\(z\)</span>-score or a <em>standard normal</em> variable.</p>
</section>
<section id="cumulative-distribution" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-distribution">Cumulative Distribution</h2>
<p>The cumulative distribution is a function <span class="math inline">\(f(x)\)</span> such that <span class="math inline">\(f(x)\)</span> is the the percentage of samples that are less than <span class="math inline">\(x\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So the median of the samples occurs where the <span class="math inline">\(y\)</span>-axis is <span class="math inline">\(.5\)</span>.</p>
</section>
<section id="quantiles" class="level2">
<h2 class="anchored" data-anchor-id="quantiles">Quantiles</h2>
<p>If <span class="math inline">\(q\)</span> is between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, then the <span class="math inline">\(q^{th}\)</span> quantile <span class="math inline">\(Q\)</span> of a random variable <span class="math inline">\(x\)</span> is the value of <span class="math inline">\(x\)</span> such that the fraction of the population with <span class="math inline">\(x&lt;Q\)</span> is <span class="math inline">\(q\)</span>.</p>
<p>The median of <span class="math inline">\(x\)</span> is the <span class="math inline">\(.5\)</span> quantile for <span class="math inline">\(x\)</span> because half of the population has values less than the median.</p>
<p>One can read quantiles from the cumulative distribution.</p>
</section>
<section id="order-statistics" class="level2">
<h2 class="anchored" data-anchor-id="order-statistics">Order Statistics</h2>
<p>The sample median and the sample quantiles (such as the 25th percentile or 75th percentile) are examples of <em>order statistics.</em></p>
<p>The smallest element, the second smallest element, and so on are other examples of <em>order statistics</em>.</p>
</section>
<section id="order-statistics-example" class="level2">
<h2 class="anchored" data-anchor-id="order-statistics-example">Order Statistics example</h2>
<p>We take 100 samples from a normal distribution and compute the median, minimum, and maximum. Then we do that 10000 times and produce a histogram.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="the-multinomial-distribution" class="level2">
<h2 class="anchored" data-anchor-id="the-multinomial-distribution">The multinomial distribution</h2>
<p>The multinomial distribution arises when you have <span class="math inline">\(n\)</span> outcomes for your experiment, say <span class="math inline">\(x_1,\ldots, x_n\)</span>; and the probability of getting <span class="math inline">\(x_i\)</span> is <span class="math inline">\(p_i\)</span>. Here we have to have <span class="math display">\[
\sum p_{i}=1.
\]</span></p>
<p>This generalizes the bernoulli distribution.</p>
</section>
<section id="mean" class="level2">
<h2 class="anchored" data-anchor-id="mean">Mean</h2>
<p>The mean of a random variable is perhaps the most important statistic associated with a probability space.</p>
<p>The mean is the “average value” of the random variable.</p>
</section>
<section id="mean-discrete-case" class="level2">
<h2 class="anchored" data-anchor-id="mean-discrete-case">Mean – discrete case</h2>
<p>In the discrete case:</p>
<p><span class="math display">\[
\overline{x}=\sum_{a\in X} x(a)p(a)
\]</span></p>
<p>In other words, the mean of <span class="math inline">\(\overline{x}\)</span> is the sum of <span class="math inline">\(x\)</span> at each event, weighted by the probability of that event.</p>
</section>
<section id="mean-of-a-bernoulli-random-variable" class="level2">
<h2 class="anchored" data-anchor-id="mean-of-a-bernoulli-random-variable">Mean of a bernoulli random variable</h2>
<p>If <span class="math inline">\(x\)</span> is bernoulli, with <span class="math inline">\(p(x=1)=p\)</span>, then the mean of <span class="math inline">\(x\)</span> is <span class="math display">\[
p(1)+(1-p)(0)=p.
\]</span></p>
</section>
<section id="mean-of-a-binomial-random-variable" class="level2">
<h2 class="anchored" data-anchor-id="mean-of-a-binomial-random-variable">Mean of a binomial random variable</h2>
<p>If <span class="math inline">\(x\)</span> is binomial, corresponding to the sum of <span class="math inline">\(N\)</span> bernoulli random variables with probability <span class="math inline">\(p\)</span>, then <span class="math display">\[
\overline{x} = \sum_{0\le i\le N} i\binom{N}{i}p^{i}(1-p)^{N-i}=Np
\]</span></p>
</section>
<section id="mean-continuous-case" class="level2">
<h2 class="anchored" data-anchor-id="mean-continuous-case">Mean – continuous case</h2>
<p>The mean of a continuous random variable is given by an integral:</p>
<p><span class="math display">\[
\overline{x} = \int_{X} xp(x) dx
\]</span></p>
<p>where <span class="math inline">\(p(x)\)</span> is the probability density. This is the limiting case of the formula in the discrete case.</p>
</section>
<section id="mean-of-standard-normal" class="level2">
<h2 class="anchored" data-anchor-id="mean-of-standard-normal">Mean of standard normal</h2>
<p>The mean of the standard normal is zero.</p>
</section>
<section id="variance-and-standard-deviation" class="level2">
<h2 class="anchored" data-anchor-id="variance-and-standard-deviation">Variance and standard deviation</h2>
<p>The variance of a random variable measures how it is distributed around its mean value.</p>
<p>In the case of a discrete random variable with outcomes values <span class="math inline">\(x\)</span> having probability <span class="math inline">\(p(x)\)</span>, the variance is <span class="math display">\[
\sum_{x} (x-\overline{x})^2p(x)
\]</span></p>
<p>This is the same as</p>
<p><span class="math display">\[
\sigma^2 = \overline{x^2}-(\overline{x})^2
\]</span></p>
<p>The standard deviation is the square root of the variance.</p>
</section>
<section id="variance-of-bernoulli" class="level2">
<h2 class="anchored" data-anchor-id="variance-of-bernoulli">Variance of Bernoulli</h2>
<p>In the Bernoulli case, the variance is <span class="math display">\[
(1-p)^2p+p^2(1-p)=p(1-p).
\]</span></p>
<p>Notice that the maximum variance happens when <span class="math inline">\(p=1/2\)</span>.</p>
</section>
<section id="variance-of-binomial" class="level2">
<h2 class="anchored" data-anchor-id="variance-of-binomial">Variance of Binomial</h2>
<p>A binomial random variable with probability <span class="math inline">\(p\)</span> and <span class="math inline">\(n\)</span> trials is a sum of <span class="math inline">\(n\)</span> bernoulli random variables with probability <span class="math inline">\(p\)</span>. Using the formula you get <span class="math display">\[
\sigma^2 = \sum_{i=0}^{n}(i-np)^2\binom{n}{i}p^{i}(1-p)^{n-i}
\]</span></p>
<p>This turns out to be <span class="math display">\[
\sigma^2 = np(1-p).
\]</span></p>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h2>
<p>A <em>statistical hypothesis</em> is a claim about a particular population. A <em>hypothesis test</em> is a method to determine which of two contradictory hypotheses is supported by the data.</p>
<p>Underlying idea: a lot of surprising things happen by chance. If you do an experiment and observe an effect, that might be the result of pure chance. Can you quantify that?</p>
</section>
<section id="an-example" class="level2">
<h2 class="anchored" data-anchor-id="an-example">An example</h2>
<p>Suppose we have a coin and we’d like to do some testing to determine if we have reason to suspect that the coin is biased. Put another way, you’d like to know if this coin behaves differently from a reference, standard coin that is fair.</p>
<p>Note this is more common than you might think. It might arise in the following circumstance in “real life.” You have two web pages, your current one and a proposed new one. You’d like to know if seeing the proposed one increases the chance of a viewer clicking through to something. This is called A/B testing and it amounts to comparing the probability of click-through in the reference case to the proposed case.</p>
</section>
<section id="null-and-alternative-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="null-and-alternative-hypotheses">Null (and alternative) hypotheses</h2>
<p>The Null hypothesis is the hypotheses that our coin is fair, or that our two web pages yield the same results, or more generally that the observations we make are accounted for only by chance and not by some underlying effect. So our null hypothesis for our coin is “P=.5”.</p>
<p>An alternative hypothesis is a statement that contradicts the null hypothesis. For example, “P&gt;.5” or “P&lt;.5” or “P is different from .5.”</p>
</section>
<section id="test-statistic" class="level2">
<h2 class="anchored" data-anchor-id="test-statistic">Test statistic</h2>
<p>A test statistic is a measurement of the data used to draw conclusions about the sample.</p>
</section>
<section id="back-to-our-example" class="level2">
<h2 class="anchored" data-anchor-id="back-to-our-example">Back to our example</h2>
<p>For our test statistic, we are going to use the fraction of times we get a head in N flips.</p>
<p>In the A/B testing situation, our test statistic would be the fraction of times a person “clicked through” when given the proposed web site.</p>
<p>Intuitively, if the fraction of heads differs significantly from the expected fraction of heads (.5) then we take that as strong evidence for the unfairness of our coin (or the increased value of our proposed web page).</p>
<p>How can we quantify this?</p>
</section>
<section id="rejection-region-and-significance" class="level2">
<h2 class="anchored" data-anchor-id="rejection-region-and-significance">Rejection region and “significance”</h2>
<p>To make things concrete, suppose the coin is fair (in other words, the null hypothesis is true) we flip the coin <span class="math inline">\(10\)</span> times. If the coin is far, we expect to get roughly 5 heads.</p>
<p>There’s a long tradition of saying something unlikely is “significant” if the chance of it occurring, assuming the null hypothesis, is less than .05 or one in twenty.</p>
<p>The chance of getting <span class="math inline">\(0\)</span>, <span class="math inline">\(1\)</span>, <span class="math inline">\(9\)</span>, or <span class="math inline">\(10\)</span> heads is <span class="math inline">\(.02\)</span>. If we allow <span class="math inline">\(2\)</span> or <span class="math inline">\(8\)</span> heads in addition, the chance is about <span class="math inline">\(11%\)</span>, so if we set our significance level at <span class="math inline">\(.05\)</span> we <em>reject the null hypothesis</em> if our experiment yields <span class="math inline">\(0\)</span>, <span class="math inline">\(1\)</span>, <span class="math inline">\(9\)</span>, or <span class="math inline">\(10\)</span> heads.</p>
<p>This is the “rejection region.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>rejection2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n,<span class="at">d=</span><span class="dv">10</span>) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,n),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>,n),n,.<span class="dv">5</span>),<span class="at">keep=</span><span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>,n),<span class="cf">function</span>(x) (x<span class="sc">&lt;</span><span class="fu">qbinom</span>(.<span class="dv">025</span>,n,.<span class="dv">5</span>)) <span class="sc">|</span> (x<span class="sc">&gt;</span><span class="fu">qbinom</span>(.<span class="dv">975</span>,n,.<span class="dv">5</span>))))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data=</span>results,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">fill=</span>keep))<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,n,d))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Two sided rejection region at alpha=.05"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>rejection1 <span class="ot">&lt;-</span><span class="cf">function</span>(n,<span class="at">d=</span><span class="dv">10</span>) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,n),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>,n),n,.<span class="dv">5</span>),<span class="at">keep=</span><span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>,n),<span class="cf">function</span>(x) (x<span class="sc">&gt;</span><span class="fu">qbinom</span>(.<span class="dv">95</span>,n,.<span class="dv">5</span>))))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data=</span>results,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">fill=</span>keep))<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,n,d))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"One sided rejection region at alpha=.05"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rejection2</span>(<span class="dv">10</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="one-sided-test" class="level2">
<h2 class="anchored" data-anchor-id="one-sided-test">One-sided test</h2>
<p>Suppose you want evidence that your coin is <em>more likely</em> to get heads. So your null hypothesis is that your coin has <span class="math inline">\(p=.5\)</span>. Your alternative hypothesis is <span class="math inline">\(p&gt;.5\)</span>.</p>
<p>The probability of getting 0,1,2 heads is <span class="math inline">\(.054\)</span>, which is a bit larger than <span class="math inline">\(.05\)</span>. So the one-sided test would reach significance only at 0 or 1 heads same as the two-sided test. But with more samples, the “one-sided” rejection region would be wider on the left than the two-sided one.</p>
<p>But suppose we did 50 flips? Then the one- and two-sided limits are slightly different.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rejection2</span>(<span class="dv">50</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rejection1</span>(<span class="dv">50</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="normal-approximation" class="level2">
<h2 class="anchored" data-anchor-id="normal-approximation">Normal approximation</h2>
<p>For large <span class="math inline">\(n\)</span>, the binomial distribution distribution with probability <span class="math inline">\(p\)</span> becomes a version of the normal distribution with mean <span class="math inline">\(Np\)</span> and standard deviation <span class="math inline">\(\sqrt{Np(1-p)}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>compare <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">p =</span> .<span class="dv">5</span>) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, n), <span class="at">y =</span> <span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>, n), n, p), <span class="at">z =</span> <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="dv">0</span>, n), <span class="at">mean =</span> p <span class="sc">*</span> n, <span class="at">sd =</span> <span class="fu">sqrt</span>(n <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> results) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> z), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="fu">glue</span>(<span class="st">"Normal Approximation to the binomial with n={n} and p={p}"</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="dv">100</span>, .<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="stat-basics_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So one can use the normal distribution to determine the rejection region if <span class="math inline">\(n\)</span> is large.</p>
</section>
<section id="errors" class="level2">
<h2 class="anchored" data-anchor-id="errors">Errors</h2>
<p>Two things can go wrong:</p>
<p>Type I error: You reject the null hypothesis, but the null hypothesis is true. The probability of a Type I error is something you choose when you set the significance level. This is usually called <span class="math inline">\(\alpha\)</span>.</p>
<p>Type II error: You accept the null hypothesis when it is false. In this case, you’ve <em>missed</em> an actual effect. This is called <span class="math inline">\(\beta\)</span>. Typically, if you make <span class="math inline">\(\alpha\)</span> smaller (thus reducing the chance of a Type I error) you make <span class="math inline">\(\beta\)</span> bigger (increasing the chance of a type II error).</p>
</section>
<section id="statistical-power" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power">Statistical Power</h2>
<p>Informally, statistical power measures the ability of an experiment to detect a real effect. If a study has high power, then you are very unlikely to make a Type II error.</p>
<p>For example, return to the coin flipping problem (or the A/B testing problem).</p>
<p>Suppose we flip our coin <span class="math inline">\(20\)</span> times and our null hypothesis is that <span class="math inline">\(p=.5\)</span> If our significance level is <span class="math inline">\(.05\)</span>, we will reject the null hypothesis and conclude that the coin is <em>not</em> fair (and biased towards heads) provided we get <span class="math inline">\(15\)</span> or more heads.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the probability density for this case</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dv">20</span>, .<span class="dv">5</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The qbinom function tells us the threshold</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>rejection <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(.<span class="dv">95</span>, <span class="dv">20</span>, .<span class="dv">5</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We check this by comparing the probability of $15-20$ vs $14-20$ heads:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs[<span class="dv">16</span><span class="sc">:</span><span class="dv">21</span>]) <span class="co"># remember probs[i] is the chance of i-1 heads</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02069473</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs[<span class="dv">15</span><span class="sc">:</span><span class="dv">21</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05765915</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The chance of $15-20$ heads is greater than $.05$.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now suppose the coin is <em>not</em> fair and <span class="math inline">\(p=.6\)</span>. What is the chance that we <em>accept</em> the null hypothesis and conclude, falsely, that the coin is fair? It is the chance that we get <span class="math inline">\(14\)</span> or fewer heads when <span class="math inline">\(p=.6\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>probs6 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dv">20</span>, .<span class="dv">6</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs6[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.874401</code></pre>
</div>
</div>
<p>This is <span class="math inline">\(87\)</span> percent! In other words, our experiment is very <em>unlikely</em> to detect the unfairness of the coin if the unfairness is only the difference between <span class="math inline">\(p=.6\)</span> and <span class="math inline">\(p=.5\)</span></p>
<p>But if the coin is <em>very</em> unfair, with, say <span class="math inline">\(p=.8\)</span>, then we find:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>probs8 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dv">20</span>, .<span class="dv">8</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs8[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1957922</code></pre>
</div>
</div>
<p>We have only a 20% chance of a Type II error so there’s an 80% chance we’ll detect the problem.</p>
<p>Now suppose we use <span class="math inline">\(100\)</span> flips.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>rejection <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(.<span class="dv">95</span>, <span class="dv">100</span>, .<span class="dv">5</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>probs6 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dv">100</span>, .<span class="dv">6</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs6[<span class="dv">1</span><span class="sc">:</span>rejection])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3032601</code></pre>
</div>
</div>
<p>Now we have a 70% chance of detecting the difference unfairness of <span class="math inline">\(p=.6\)</span>. <!--
some things to talk about:
fisher exact test  (likelihood of results at random)
datatypes and types of random variables (ints are discrete/continuous?)
relationship between *density function* and *histogram*
empirical distribution
--></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>